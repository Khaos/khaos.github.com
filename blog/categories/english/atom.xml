<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: English | Khaos]]></title>
  <link href="http://Khaos.github.com/blog/categories/english/atom.xml" rel="self"/>
  <link href="http://Khaos.github.com/"/>
  <updated>2012-12-06T20:33:57+08:00</updated>
  <id>http://Khaos.github.com/</id>
  <author>
    <name><![CDATA[Dazhi Jiang]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Create a Bode plot using PGF/TikZ, TikZ Tao]]></title>
    <link href="http://Khaos.github.com/blog/2010/03/24/create-a-bode-plot-using-pgftikz/"/>
    <updated>2010-03-24T00:00:00+08:00</updated>
    <id>http://Khaos.github.com/blog/2010/03/24/create-a-bode-plot-using-pgftikz</id>
    <content type="html"><![CDATA[<p>How to draw a Bode plot? Well, the answer seams easy. If you have a  MATLAB distribution with Control System Toolbox, you can do this using just a single command, for example, </p>

<p><code>matlab
	bode(tf(4, [2, 1, 0]));
</code></p>

<p>Indeed, MATLAB integrates so many powerful tools that make scientists and engineers’ lives easier. However, this is not the end of our story. Yes, the figure created in MATLAB looks really, really ugly. If you want a publishable quality figure, which includes more colors, more line styles, more elegant annotations and even more, the mathematical equations, you will feel utterly disappointed in the MATLAB’s plotting ability.</p>

<p>So what is the solution?</p>

<!-- more -->

<ul>
  <li>R + Sweave/pgfSweave? Unfortunately, as far as I know, R (and its official package repository) does not provide a bode-plot relevant function. (If anyone knows such a function (or better, a control system package), please leave your comment here. Thanks.)</li>
  <li>Python + Numpy/Scipy + matplotlib? Yer, this looks like a happy combination. However, you have to learn Python, and, of course, Numpy/Scipy/matplotlib.</li>
  <li>MATLAB + matlab2pgfplots/matlab2tikz? A clumsy method, and even worse, it does now work for the figure create by <code>bode()</code> function. (In MATLAB 2009b or earlier, the objects generated by the function <code>bode()</code> is quite different from ones generated by the standard plotting command <code>plot()</code>. So you won’t get what you want, if you simply use matlab2pgfplots/matlab2tikz to convert MATLAB figure to PGF/TikZ file. Of course, there are some tricks to do it.)</li>
  <li>Octave + gnuplot + epslatex/pslatex? OK, it could do the job. But how to put an equation in the upper subfigure (magnitude)? Again need some tricks and more complicate.</li>
  <li>gnuplot + tikz terminal? This is a solution that satisfies everything. But do you really want to switch between gnuplot and tex all the time when you revise your work? Unless you are an emacs/Vim user, you will find this process is pretty annoying.</li>
  <li>Can we do everything in TeX?</li>
</ul>

<p>The answer is yes. Thank Papanicola Robert for his excellent work, the LaTeX package, <a href="http://www.sciences-indus-cpge.apinc.org/Bode-Black-et-Nyquist-avec-Tikz">bodegraph</a> (PGF/TikZ based). Now using a single toolset, in a single editing environment, do a beautiful job. The below is the tex file which draws the bode plots for two control systems.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>bodeplot (bodeplot.tex)</span> <a href='/downloads/code/2010/bodeplot.tex'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
</pre></td><td class='code'><pre><code class='tex'><span class='line'><span class="c">% Create a Bode plot using Papanicola Robert&#39;s package &lt;bodegraph&gt;</span>
</span><span class='line'><span class="c">% Author: Dazhi Jiang</span>
</span><span class='line'><span class="k">\documentclass</span><span class="na">[10pt]</span><span class="nb">{</span>article<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\usepackage</span><span class="nb">{</span>amsmath,amssymb<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\usepackage</span><span class="nb">{</span>tikz<span class="nb">}</span>
</span><span class='line'><span class="k">\usepackage</span><span class="nb">{</span>bodegraph<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\usetikzlibrary</span><span class="nb">{</span>intersections<span class="nb">}</span>
</span><span class='line'><span class="k">\usetikzlibrary</span><span class="nb">{</span>calc<span class="nb">}</span>
</span><span class='line'><span class="k">\usetikzlibrary</span><span class="nb">{</span>positioning<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\usepackage</span><span class="na">[active,tightpage]</span><span class="nb">{</span>preview<span class="nb">}</span>
</span><span class='line'><span class="k">\PreviewEnvironment</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>document<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Define the layers to draw the diagram</span>
</span><span class='line'><span class="k">\pgfdeclarelayer</span><span class="nb">{</span>background<span class="nb">}</span>
</span><span class='line'><span class="k">\pgfdeclarelayer</span><span class="nb">{</span>foreground<span class="nb">}</span>
</span><span class='line'><span class="k">\pgfsetlayers</span><span class="nb">{</span>background,main,foreground<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>[&gt;=latex&#39;,
</span><span class='line'>    ref lines/.style=<span class="nb">{</span>thin, blue!60<span class="nb">}</span>,
</span><span class='line'>    ref points/.style=<span class="nb">{</span>circle, black, opacity=0.7, fill, minimum size= 3pt, inner sep=0<span class="nb">}</span>,
</span><span class='line'>    every node/.style=<span class="nb">{</span>font=<span class="k">\small</span><span class="nb">}</span>,
</span><span class='line'>    bode lines/.style=<span class="nb">{</span>very thick, blue<span class="nb">}</span>,
</span><span class='line'>    Gclabel/.style=<span class="nb">{</span>text=blue<span class="nb">}</span>,
</span><span class='line'>    xscale=12/3]
</span><span class='line'>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>scope<span class="nb">}</span>[yscale=4/110]
</span><span class='line'><span class="k">\UnitedB</span>
</span><span class='line'><span class="k">\semilog</span><span class="nb">{</span>-1<span class="nb">}{</span>2<span class="nb">}{</span>-50<span class="nb">}{</span>60<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Bode plot (magnitude) for the original system, 4/(s/(1+2s)).</span>
</span><span class='line'><span class="c">% Asymptotic line</span>
</span><span class='line'><span class="k">\BodeAmp</span><span class="na">[ref lines, red!60]</span><span class="nb">{</span>-1:1.35<span class="nb">}{</span><span class="k">\POAmpAsymp</span><span class="nb">{</span>4<span class="nb">}{</span>2.0<span class="nb">}</span>+<span class="k">\IntAmp</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'><span class="c">% Bode plot</span>
</span><span class='line'><span class="k">\BodeAmp</span><span class="na">[bode lines, red, name path=Gomagnitude]</span><span class="nb">{</span>-1:1.35<span class="nb">}{</span><span class="k">\POAmp</span><span class="nb">{</span>4<span class="nb">}{</span>2.0<span class="nb">}</span>+<span class="k">\IntAmp</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Bode plot (magnitude) for the compensated system, 4(1+s)/(s^2/(1+0.1s)).</span>
</span><span class='line'><span class="c">% Asymptotic line</span>
</span><span class='line'><span class="k">\BodeAmp</span><span class="na">[ref lines]</span><span class="nb">{</span>-1:2<span class="nb">}{</span><span class="k">\APAmpAsymp</span><span class="nb">{</span>4<span class="nb">}{</span>0.1<span class="nb">}{</span>10<span class="nb">}</span>+2*<span class="k">\IntAmp</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'><span class="c">% Bode plot</span>
</span><span class='line'><span class="k">\BodeAmp</span><span class="na">[bode lines, name path=magnitude]</span>
</span><span class='line'>    <span class="nb">{</span>-1:2<span class="nb">}{</span><span class="k">\APAmp</span><span class="nb">{</span>4<span class="nb">}{</span>0.1<span class="nb">}{</span>10<span class="nb">}</span>+2*<span class="k">\IntAmp</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Reference line, (0dB)</span>
</span><span class='line'><span class="k">\draw</span> [name path=unitygain, ref lines] (-1,0) -- (2,0);
</span><span class='line'>
</span><span class='line'><span class="c">% Crossover frequency of the original system</span>
</span><span class='line'><span class="k">\path</span> [name intersections=<span class="nb">{</span>of=magnitude and unitygain, by=crossover<span class="nb">}</span>];
</span><span class='line'><span class="k">\node</span> (coref) [ref points, label=<span class="nb">{</span>[blue]below left:<span class="s">$</span><span class="nv">\omega</span><span class="nb">_c</span><span class="s">$</span><span class="nb">}</span>]
</span><span class='line'>    at (crossover) <span class="nb">{}</span>;
</span><span class='line'>
</span><span class='line'><span class="c">% Crossover frequency of the compensated system</span>
</span><span class='line'><span class="k">\path</span> [name intersections=<span class="nb">{</span>of=Gomagnitude and unitygain, by=Gocrossover<span class="nb">}</span>];
</span><span class='line'><span class="k">\node</span> (Gocoref) [ref points, label=<span class="nb">{</span>[red]below:<span class="s">$</span><span class="nv">\omega</span><span class="nb">_{co}</span><span class="s">$</span><span class="nb">}</span>]
</span><span class='line'>    at (Gocrossover) <span class="nb">{}</span>;
</span><span class='line'>
</span><span class='line'><span class="c">% Labels for the original system (open-loop)</span>
</span><span class='line'><span class="k">\node</span> [Gclabel, text=red] at (-0.7, 15) <span class="nb">{</span><span class="s">$</span><span class="o">-</span><span class="m">20</span><span class="s">$</span>dB/dec<span class="nb">}</span>;
</span><span class='line'><span class="k">\node</span> [Gclabel, text=red] at (0.5, -30) <span class="nb">{</span><span class="s">$</span><span class="o">-</span><span class="m">40</span><span class="s">$</span>dB/dec<span class="nb">}</span>;
</span><span class='line'><span class="k">\node</span> (KG) [Gclabel, red!60, text=red, draw]
</span><span class='line'>    at (-0.5, -30) <span class="nb">{</span><span class="s">$</span><span class="nb">KG</span><span class="o">(</span><span class="nb">s</span><span class="o">)=</span><span class="nv">\dfrac</span><span class="nb">{</span><span class="m">4</span><span class="nb">}{s</span><span class="o">(</span><span class="m">1</span><span class="o">+</span><span class="m">2</span><span class="nb">s</span><span class="o">)</span><span class="nb">}</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'><span class="k">\draw</span> (KG.east) edge [-&gt;, shorten &gt;=1pt, thick, red, bend right=1.5]
</span><span class='line'>    (0.4, -10);
</span><span class='line'>
</span><span class='line'><span class="c">% Labels for the compensated system (open-loop)</span>
</span><span class='line'><span class="k">\node</span> [ref points, label=<span class="nb">{</span>[blue]below left:<span class="s">$</span><span class="nv">\omega</span><span class="nb">_</span><span class="m">2</span><span class="s">$</span><span class="nb">}</span>] at (0, 0) <span class="nb">{}</span>;
</span><span class='line'><span class="k">\node</span> [ref points, label=<span class="nb">{</span>[blue]below right:<span class="s">$</span><span class="nv">\omega</span><span class="nb">_</span><span class="m">3</span><span class="s">$</span><span class="nb">}</span>] at (1, 0) <span class="nb">{}</span>;
</span><span class='line'><span class="k">\node</span> [Gclabel] at (-0.4, 40) <span class="nb">{</span><span class="s">$</span><span class="o">-</span><span class="m">40</span><span class="s">$</span>dB/dec<span class="nb">}</span>;
</span><span class='line'><span class="k">\node</span> [Gclabel] at (0.5, 10) <span class="nb">{</span><span class="s">$</span><span class="o">-</span><span class="m">20</span><span class="s">$</span>dB/dec<span class="nb">}</span>;
</span><span class='line'><span class="k">\node</span> [Gclabel] at (1.6, -20) <span class="nb">{</span><span class="s">$</span><span class="o">-</span><span class="m">40</span><span class="s">$</span>dB/dec<span class="nb">}</span>;
</span><span class='line'><span class="k">\node</span> (KDG) [Gclabel, blue!60, text=blue, draw]
</span><span class='line'>    at (1.4, 40) <span class="nb">{</span><span class="s">$</span><span class="nb">KD</span><span class="o">(</span><span class="nb">s</span><span class="o">)</span><span class="nb">G</span><span class="o">(</span><span class="nb">s</span><span class="o">)=</span><span class="nv">\dfrac</span><span class="nb">{</span><span class="m">4</span><span class="o">(</span><span class="m">1</span><span class="o">+</span><span class="nb">s</span><span class="o">)</span><span class="nb">}{s^</span><span class="m">2</span><span class="o">(</span><span class="m">1</span><span class="o">+</span><span class="m">0</span><span class="nb">.</span><span class="m">1</span><span class="nb">s</span><span class="o">)</span><span class="nb">}</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'><span class="k">\draw</span> (KDG.west) edge [-&gt;, shorten &gt;=1pt, thick, blue, bend right=1.5]
</span><span class='line'>    (0.17, 10);
</span><span class='line'>
</span><span class='line'><span class="c">% Axes label</span>
</span><span class='line'><span class="k">\node</span> [below=6pt] at (0.5,-50) <span class="nb">{</span>Frequency, <span class="s">$</span><span class="nv">\omega</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'><span class="k">\node</span> [rotate=90] at (-1.25,5) <span class="nb">{</span>Magnitude, <span class="s">$</span><span class="m">20</span><span class="nv">\log</span><span class="o">(</span><span class="nb">|G</span><span class="o">(</span><span class="nv">\text</span><span class="nb">{j}</span><span class="nv">\omega</span><span class="o">)</span><span class="nb">|</span><span class="o">)</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>scope<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>scope<span class="nb">}</span>[yshift=-3.5cm,yscale=4/180]
</span><span class='line'><span class="k">\UniteDegre</span>
</span><span class='line'><span class="k">\OrdBode</span><span class="nb">{</span>30<span class="nb">}</span>
</span><span class='line'><span class="k">\semilog</span><span class="nb">{</span>-1<span class="nb">}{</span>2<span class="nb">}{</span>-180<span class="nb">}{</span>0<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Bode plot (phase) for the original system, 4/(s/(1+2s)).</span>
</span><span class='line'><span class="c">% Asymptotic line</span>
</span><span class='line'><span class="k">\BodeArg</span><span class="na">[ref lines, red!60]</span><span class="nb">{</span>-1:2<span class="nb">}{</span><span class="k">\POArgAsymp</span><span class="nb">{</span>4<span class="nb">}{</span>2.0<span class="nb">}</span>+<span class="k">\IntArg</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'><span class="c">% Bode plot</span>
</span><span class='line'><span class="k">\BodeArg</span><span class="na">[bode lines, red, name path=Gophase]</span><span class="nb">{</span>-1:2<span class="nb">}{</span><span class="k">\POArg</span><span class="nb">{</span>4<span class="nb">}{</span>2<span class="nb">}</span>+<span class="k">\IntArg</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Bode plot (magnitude) for the compensated system, 4(1+s)/(s^2/(1+0.1s)).</span>
</span><span class='line'><span class="c">% Asymptotic line</span>
</span><span class='line'><span class="k">\BodeArg</span><span class="na">[ref lines]</span><span class="nb">{</span>-1:2<span class="nb">}{</span><span class="k">\APArgAsymp</span><span class="nb">{</span>4<span class="nb">}{</span>0.1<span class="nb">}{</span>10<span class="nb">}</span>+2*<span class="k">\IntArg</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'><span class="c">% Bode plot</span>
</span><span class='line'><span class="k">\BodeArg</span><span class="na">[bode lines, name path=phase]</span><span class="nb">{</span>-1:2<span class="nb">}{</span><span class="k">\APArg</span><span class="nb">{</span>4<span class="nb">}{</span>0.1<span class="nb">}{</span>10<span class="nb">}</span>+2*<span class="k">\IntArg</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Phase margin of the original system</span>
</span><span class='line'><span class="k">\path</span> [name path=Gowcref] (Gocrossover) -- ++(0,-330);
</span><span class='line'><span class="k">\path</span> [name intersections=<span class="nb">{</span>of=Gophase and Gowcref, by=Gophasemargin<span class="nb">}</span>];
</span><span class='line'><span class="k">\node</span> (Gopmref) [ref points] at (Gophasemargin) <span class="nb">{}</span>;
</span><span class='line'><span class="k">\draw</span> [ref lines, red!60, densely dotted] (Gocoref.south) -- (Gopmref.north);
</span><span class='line'><span class="k">\draw</span> [ref lines, &lt;-&gt;, red] let <span class="k">\p</span>1=(Gophasemargin)
</span><span class='line'>    in
</span><span class='line'>        (Gopmref.south) -- node[left, Gclabel, text=red] <span class="nb">{</span><span class="s">$</span><span class="nv">\text</span><span class="nb">{PM}_o</span><span class="s">$</span><span class="nb">}</span> (<span class="k">\x</span>1,-180);
</span><span class='line'>
</span><span class='line'><span class="c">% Phase margin of the compensated system</span>
</span><span class='line'><span class="k">\path</span><span class="na">[name path=wcref]</span> (crossover) -- ++(0,-300);
</span><span class='line'><span class="k">\path</span> [name intersections=<span class="nb">{</span>of=phase and wcref, by=phasemargin<span class="nb">}</span>];
</span><span class='line'><span class="k">\node</span> (pmref) [ref points] at (phasemargin) <span class="nb">{}</span>;
</span><span class='line'><span class="k">\draw</span> [ref lines, densely dotted] (coref.south) -- (pmref.north);
</span><span class='line'><span class="k">\draw</span> [ref lines, &lt;-&gt;, blue] let <span class="k">\p</span>1=(phasemargin)
</span><span class='line'>    in
</span><span class='line'>        (pmref.south) -- node[left, Gclabel] <span class="nb">{</span>PM<span class="nb">}</span> (<span class="k">\x</span>1,-180);
</span><span class='line'>
</span><span class='line'><span class="c">% System Labels</span>
</span><span class='line'><span class="k">\node</span> (KGphase) [Gclabel, red!60, text=red, draw]
</span><span class='line'>    at (-0.5, -40) <span class="nb">{</span><span class="s">$</span><span class="nb">KG</span><span class="o">(</span><span class="nb">s</span><span class="o">)=</span><span class="nv">\dfrac</span><span class="nb">{</span><span class="m">4</span><span class="nb">}{s</span><span class="o">(</span><span class="m">1</span><span class="o">+</span><span class="m">2</span><span class="nb">s</span><span class="o">)</span><span class="nb">}</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'><span class="k">\draw</span><span class="na">[-&gt;, shorten &gt;=1pt, thick, red]</span>
</span><span class='line'>    (KGphase.south) .. controls +(down:30) and +(0.1,10) .. (-0.65, -114);
</span><span class='line'>
</span><span class='line'><span class="k">\node</span> (KDGphase) [Gclabel, blue!60, text=blue, draw]
</span><span class='line'>    at (1.4, -40) <span class="nb">{</span><span class="s">$</span><span class="nb">KD</span><span class="o">(</span><span class="nb">s</span><span class="o">)</span><span class="nb">G</span><span class="o">(</span><span class="nb">s</span><span class="o">)=</span><span class="nv">\dfrac</span><span class="nb">{</span><span class="m">4</span><span class="o">(</span><span class="m">1</span><span class="o">+</span><span class="nb">s</span><span class="o">)</span><span class="nb">}{s^</span><span class="m">2</span><span class="o">(</span><span class="m">1</span><span class="o">+</span><span class="m">0</span><span class="nb">.</span><span class="m">1</span><span class="nb">s</span><span class="o">)</span><span class="nb">}</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'><span class="k">\draw</span><span class="na">[-&gt;, shorten &gt;=1pt, thick, blue]</span>
</span><span class='line'>    (KDGphase.south) .. controls +(down:40) and +(0.1,30) .. (1.1, -146);
</span><span class='line'>
</span><span class='line'><span class="c">% Axes label</span>
</span><span class='line'><span class="k">\node</span> [below=6pt] at (0.5, -180) <span class="nb">{</span>Frequency, <span class="s">$</span><span class="nv">\omega</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'><span class="k">\node</span> [rotate=90] at (-1.25, -90) <span class="nb">{</span>Phase, <span class="s">$</span><span class="nv">\angle</span><span class="nb"> G</span><span class="o">(</span><span class="nv">\text</span><span class="nb">{j}</span><span class="nv">\omega</span><span class="o">)</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>scope<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Background</span>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>pgfonlayer<span class="nb">}{</span>background<span class="nb">}</span>
</span><span class='line'>    <span class="k">\path</span> (-1.4cm,2.8cm) node (tl) <span class="nb">{}</span>;
</span><span class='line'>    <span class="k">\path</span> (2.3cm, -8.4cm) node (br) <span class="nb">{}</span>;
</span><span class='line'>
</span><span class='line'>    <span class="k">\path</span><span class="na">[fill=brown!20]</span> (tl) rectangle (br);
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>pgfonlayer<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>document<span class="nb">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Here is he thumbnail of the plot. You can find the <a href="http://cid-e5b806d2c8679f5d.skydrive.live.com/self.aspx/Public/TeX/bodeplot.tex">tex</a> and <a href="http://cid-e5b806d2c8679f5d.skydrive.live.com/self.aspx/Public/TeX/bodeplot.pdf">pdf</a> file from my SkyDrive.</p>

<p class="fn-img" style="max-width: 450px;"><img src="https://raw.github.com/Khaos/TikZGallery/master/Figs/png/pgf-o-Bodeplot.png" alt="The bodeplots of two control systems" /></p>

<p class="info">Update: <br />
    The code has been included in the PGF/Ti<em>k</em>Z gallery, <a href="http://www.texample.net/">TeXample.net</a>, see <a href="http://www.texample.net/tikz/examples/bode-plot/">here</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Spirit, a Sad Story]]></title>
    <link href="http://Khaos.github.com/blog/2010/02/12/spirit/"/>
    <updated>2010-02-12T00:00:00+08:00</updated>
    <id>http://Khaos.github.com/blog/2010/02/12/spirit</id>
    <content type="html"><![CDATA[<p>WHAT MAKES US HUMAN?</p>

<!-- more -->

<p>The original story is posted at <a href="http://xkcd.com/695/">xkcd</a>.</p>

<p class="fn-img"><img src="../../../../../images/blog/2010/spirit.png" alt="GUI prototype" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The Final GUI, Matlab Tao (2)]]></title>
    <link href="http://Khaos.github.com/blog/2009/12/07/matlab-toolbox-gui-first-release/"/>
    <updated>2009-12-07T00:00:00+08:00</updated>
    <id>http://Khaos.github.com/blog/2009/12/07/matlab-toolbox-gui-first-release</id>
    <content type="html"><![CDATA[<p>Some screenshots of the ACSE Teaching &amp; Testing system.</p>

<!-- more -->

<table>
  <tbody>
    <tr>
      <td>Welcome Page</td>
      <td>Finish Page</td>
    </tr>
    <tr>
      <td><img src="../../../../../images/blog/2009/acs114prototype025b85d.png" alt="GUI prototype" /></td>
      <td><img src="../../../../../images/blog/2009/page-last015b55d.png" alt="GUI prototype" /></td>
    </tr>
    <tr>
      <td>Demo Page</td>
      <td>Question 1</td>
    </tr>
    <tr>
      <td><img src="../../../../../images/blog/2009/page015b105d.png" alt="GUI prototype" /></td>
      <td><img src="../../../../../images/blog/2009/page025b45d.png" alt="GUI prototype" /></td>
    </tr>
    <tr>
      <td>Question 3a</td>
      <td>Question 3b</td>
    </tr>
    <tr>
      <td><img src="../../../../../images/blog/2009/page04a5b45d.png" alt="GUI prototype" /></td>
      <td><img src="../../../../../images/blog/2009/page04b5b45d.png" alt="GUI prototype" /></td>
    </tr>
    <tr>
      <td>Question 2</td>
      <td>Question 5</td>
    </tr>
    <tr>
      <td><img src="../../../../../images/blog/2009/page035b45d.png" alt="GUI prototype" /></td>
      <td><img src="../../../../../images/blog/2009/page055b45d.png" alt="GUI prototype" /></td>
    </tr>
  </tbody>
</table>

<p class="infoup">The GUI has been upgraded since the first release. Many improvements and bug fixes have been done. I will release a demo GUI on GitHub later.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A GUI Prototype for ACSE Course Testing System, Matlab Tao (1)]]></title>
    <link href="http://Khaos.github.com/blog/2009/11/30/matlab-toolbox-gui-prototype/"/>
    <updated>2009-11-30T00:00:00+08:00</updated>
    <id>http://Khaos.github.com/blog/2009/11/30/matlab-toolbox-gui-prototype</id>
    <content type="html"><![CDATA[<p>I’ve recently been asked to design a new testing system (toolbox) for the first year students of ACSE. The purpose is to create a easy-to-use Matlab GUI to help the student to fulfil a self-testing task.</p>

<p>After a few days work, I got my first GUI prototype (see below) which has dark background and light foreground.</p>

<!-- more -->

<p class="fn-img" style="max-width: 450px;"><img src="../../../../../images/blog/2009/acs114prototype025b85d.png" alt="GUI prototype" /></p>

<p>I’m planning to improve this GUI by embedding a tab panel in the question zone. However, there is no standard tab panel GUI component in Matlab. So it has to be built either using the undocumented Java classes (need more Java *_* ) or using a group of the basic Matlab GUI components (more codes -_-<font size="1">P</font> ). I’m going to show the final design when I finish this project.</p>

]]></content>
  </entry>
  
</feed>
