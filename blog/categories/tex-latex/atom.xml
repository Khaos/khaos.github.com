<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: TeX/LaTeX | Khaos]]></title>
  <link href="http://Khaos.github.com/blog/categories/tex-latex/atom.xml" rel="self"/>
  <link href="http://Khaos.github.com/"/>
  <updated>2012-12-06T13:35:58+08:00</updated>
  <id>http://Khaos.github.com/</id>
  <author>
    <name><![CDATA[Dazhi Jiang]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Create a Bode plot using PGF/TikZ]]></title>
    <link href="http://Khaos.github.com/blog/2010/03/24/create-a-bode-plot-using-pgftikz/"/>
    <updated>2010-03-24T00:00:00+08:00</updated>
    <id>http://Khaos.github.com/blog/2010/03/24/create-a-bode-plot-using-pgftikz</id>
    <content type="html"><![CDATA[<p>How to draw a Bode plot? Well, the answer seams easy. If you have a  MATLAB distribution with Control System Toolbox, you can do this using just a single command, for example, </p>

<p><code>matlab
	bode(tf(4, [2, 1, 0]));
</code></p>

<p>Indeed, MATLAB integrates so many powerful tools that make scientists and engineers’ lives easier. However, this is not the end of our story. Yes, the figure created in MATLAB looks really, really ugly. If you want a publishable quality figure, which includes more colors, more line styles, more elegant annotations and even more, the mathematical equations, you will feel utterly disappointed in the MATLAB’s plotting ability.</p>

<p>So what is the solution?</p>

<!-- more -->

<ul>
  <li>R + Sweave/pgfSweave? Unfortunately, as far as I know, R (and its official package repository) does not provide a bode-plot relevant function. (If anyone knows such a function (or better, a control system package), please leave your comment here. Thanks.)</li>
  <li>Python + Numpy/Scipy + matplotlib? Yer, this looks like a happy combination. However, you have to learn Python, and, of course, Numpy/Scipy/matplotlib.</li>
  <li>MATLAB + matlab2pgfplots/matlab2tikz? A clumsy method, and even worse, it does now work for the figure create by <code>bode()</code> function. (In MATLAB 2009b or earlier, the objects generated by the function <code>bode()</code> is quite different from ones generated by the standard plotting command <code>plot()</code>. So you won’t get what you want, if you simply use matlab2pgfplots/matlab2tikz to convert MATLAB figure to PGF/TikZ file. Of course, there are some tricks to do it.)</li>
  <li>Octave + gnuplot + epslatex/pslatex? OK, it could do the job. But how to put an equation in the upper subfigure (magnitude)? Again need some tricks and more complicate.</li>
  <li>gnuplot + tikz terminal? This is a solution that satisfies everything. But do you really want to switch between gnuplot and tex all the time when you revise your work? Unless you are an emacs/Vim user, you will find this process is pretty annoying.</li>
  <li>Can we do everything in TeX?</li>
</ul>

<p>The answer is yes. Thank Papanicola Robert for his excellent work, the LaTeX package, <a href="http://www.sciences-indus-cpge.apinc.org/Bode-Black-et-Nyquist-avec-Tikz">bodegraph</a> (PGF/TikZ based). Now using a single toolset, in a single editing environment, do a beautiful job. The below is the tex file which draws the bode plots for two control systems.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>bodeplot (bodeplot.tex)</span> <a href='/downloads/code/2010/bodeplot.tex'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
</pre></td><td class='code'><pre><code class='tex'><span class='line'><span class="c">% Create a Bode plot using Papanicola Robert&#39;s package &lt;bodegraph&gt;</span>
</span><span class='line'><span class="c">% Author: Dazhi Jiang</span>
</span><span class='line'><span class="k">\documentclass</span><span class="na">[10pt]</span><span class="nb">{</span>article<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\usepackage</span><span class="nb">{</span>amsmath,amssymb<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\usepackage</span><span class="nb">{</span>tikz<span class="nb">}</span>
</span><span class='line'><span class="k">\usepackage</span><span class="nb">{</span>bodegraph<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\usetikzlibrary</span><span class="nb">{</span>intersections<span class="nb">}</span>
</span><span class='line'><span class="k">\usetikzlibrary</span><span class="nb">{</span>calc<span class="nb">}</span>
</span><span class='line'><span class="k">\usetikzlibrary</span><span class="nb">{</span>positioning<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\usepackage</span><span class="na">[active,tightpage]</span><span class="nb">{</span>preview<span class="nb">}</span>
</span><span class='line'><span class="k">\PreviewEnvironment</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>document<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Define the layers to draw the diagram</span>
</span><span class='line'><span class="k">\pgfdeclarelayer</span><span class="nb">{</span>background<span class="nb">}</span>
</span><span class='line'><span class="k">\pgfdeclarelayer</span><span class="nb">{</span>foreground<span class="nb">}</span>
</span><span class='line'><span class="k">\pgfsetlayers</span><span class="nb">{</span>background,main,foreground<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>[&gt;=latex&#39;,
</span><span class='line'>    ref lines/.style=<span class="nb">{</span>thin, blue!60<span class="nb">}</span>,
</span><span class='line'>    ref points/.style=<span class="nb">{</span>circle, black, opacity=0.7, fill, minimum size= 3pt, inner sep=0<span class="nb">}</span>,
</span><span class='line'>    every node/.style=<span class="nb">{</span>font=<span class="k">\small</span><span class="nb">}</span>,
</span><span class='line'>    bode lines/.style=<span class="nb">{</span>very thick, blue<span class="nb">}</span>,
</span><span class='line'>    Gclabel/.style=<span class="nb">{</span>text=blue<span class="nb">}</span>,
</span><span class='line'>    xscale=12/3]
</span><span class='line'>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>scope<span class="nb">}</span>[yscale=4/110]
</span><span class='line'><span class="k">\UnitedB</span>
</span><span class='line'><span class="k">\semilog</span><span class="nb">{</span>-1<span class="nb">}{</span>2<span class="nb">}{</span>-50<span class="nb">}{</span>60<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Bode plot (magnitude) for the original system, 4/(s/(1+2s)).</span>
</span><span class='line'><span class="c">% Asymptotic line</span>
</span><span class='line'><span class="k">\BodeAmp</span><span class="na">[ref lines, red!60]</span><span class="nb">{</span>-1:1.35<span class="nb">}{</span><span class="k">\POAmpAsymp</span><span class="nb">{</span>4<span class="nb">}{</span>2.0<span class="nb">}</span>+<span class="k">\IntAmp</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'><span class="c">% Bode plot</span>
</span><span class='line'><span class="k">\BodeAmp</span><span class="na">[bode lines, red, name path=Gomagnitude]</span><span class="nb">{</span>-1:1.35<span class="nb">}{</span><span class="k">\POAmp</span><span class="nb">{</span>4<span class="nb">}{</span>2.0<span class="nb">}</span>+<span class="k">\IntAmp</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Bode plot (magnitude) for the compensated system, 4(1+s)/(s^2/(1+0.1s)).</span>
</span><span class='line'><span class="c">% Asymptotic line</span>
</span><span class='line'><span class="k">\BodeAmp</span><span class="na">[ref lines]</span><span class="nb">{</span>-1:2<span class="nb">}{</span><span class="k">\APAmpAsymp</span><span class="nb">{</span>4<span class="nb">}{</span>0.1<span class="nb">}{</span>10<span class="nb">}</span>+2*<span class="k">\IntAmp</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'><span class="c">% Bode plot</span>
</span><span class='line'><span class="k">\BodeAmp</span><span class="na">[bode lines, name path=magnitude]</span>
</span><span class='line'>    <span class="nb">{</span>-1:2<span class="nb">}{</span><span class="k">\APAmp</span><span class="nb">{</span>4<span class="nb">}{</span>0.1<span class="nb">}{</span>10<span class="nb">}</span>+2*<span class="k">\IntAmp</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Reference line, (0dB)</span>
</span><span class='line'><span class="k">\draw</span> [name path=unitygain, ref lines] (-1,0) -- (2,0);
</span><span class='line'>
</span><span class='line'><span class="c">% Crossover frequency of the original system</span>
</span><span class='line'><span class="k">\path</span> [name intersections=<span class="nb">{</span>of=magnitude and unitygain, by=crossover<span class="nb">}</span>];
</span><span class='line'><span class="k">\node</span> (coref) [ref points, label=<span class="nb">{</span>[blue]below left:<span class="s">$</span><span class="nv">\omega</span><span class="nb">_c</span><span class="s">$</span><span class="nb">}</span>]
</span><span class='line'>    at (crossover) <span class="nb">{}</span>;
</span><span class='line'>
</span><span class='line'><span class="c">% Crossover frequency of the compensated system</span>
</span><span class='line'><span class="k">\path</span> [name intersections=<span class="nb">{</span>of=Gomagnitude and unitygain, by=Gocrossover<span class="nb">}</span>];
</span><span class='line'><span class="k">\node</span> (Gocoref) [ref points, label=<span class="nb">{</span>[red]below:<span class="s">$</span><span class="nv">\omega</span><span class="nb">_{co}</span><span class="s">$</span><span class="nb">}</span>]
</span><span class='line'>    at (Gocrossover) <span class="nb">{}</span>;
</span><span class='line'>
</span><span class='line'><span class="c">% Labels for the original system (open-loop)</span>
</span><span class='line'><span class="k">\node</span> [Gclabel, text=red] at (-0.7, 15) <span class="nb">{</span><span class="s">$</span><span class="o">-</span><span class="m">20</span><span class="s">$</span>dB/dec<span class="nb">}</span>;
</span><span class='line'><span class="k">\node</span> [Gclabel, text=red] at (0.5, -30) <span class="nb">{</span><span class="s">$</span><span class="o">-</span><span class="m">40</span><span class="s">$</span>dB/dec<span class="nb">}</span>;
</span><span class='line'><span class="k">\node</span> (KG) [Gclabel, red!60, text=red, draw]
</span><span class='line'>    at (-0.5, -30) <span class="nb">{</span><span class="s">$</span><span class="nb">KG</span><span class="o">(</span><span class="nb">s</span><span class="o">)=</span><span class="nv">\dfrac</span><span class="nb">{</span><span class="m">4</span><span class="nb">}{s</span><span class="o">(</span><span class="m">1</span><span class="o">+</span><span class="m">2</span><span class="nb">s</span><span class="o">)</span><span class="nb">}</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'><span class="k">\draw</span> (KG.east) edge [-&gt;, shorten &gt;=1pt, thick, red, bend right=1.5]
</span><span class='line'>    (0.4, -10);
</span><span class='line'>
</span><span class='line'><span class="c">% Labels for the compensated system (open-loop)</span>
</span><span class='line'><span class="k">\node</span> [ref points, label=<span class="nb">{</span>[blue]below left:<span class="s">$</span><span class="nv">\omega</span><span class="nb">_</span><span class="m">2</span><span class="s">$</span><span class="nb">}</span>] at (0, 0) <span class="nb">{}</span>;
</span><span class='line'><span class="k">\node</span> [ref points, label=<span class="nb">{</span>[blue]below right:<span class="s">$</span><span class="nv">\omega</span><span class="nb">_</span><span class="m">3</span><span class="s">$</span><span class="nb">}</span>] at (1, 0) <span class="nb">{}</span>;
</span><span class='line'><span class="k">\node</span> [Gclabel] at (-0.4, 40) <span class="nb">{</span><span class="s">$</span><span class="o">-</span><span class="m">40</span><span class="s">$</span>dB/dec<span class="nb">}</span>;
</span><span class='line'><span class="k">\node</span> [Gclabel] at (0.5, 10) <span class="nb">{</span><span class="s">$</span><span class="o">-</span><span class="m">20</span><span class="s">$</span>dB/dec<span class="nb">}</span>;
</span><span class='line'><span class="k">\node</span> [Gclabel] at (1.6, -20) <span class="nb">{</span><span class="s">$</span><span class="o">-</span><span class="m">40</span><span class="s">$</span>dB/dec<span class="nb">}</span>;
</span><span class='line'><span class="k">\node</span> (KDG) [Gclabel, blue!60, text=blue, draw]
</span><span class='line'>    at (1.4, 40) <span class="nb">{</span><span class="s">$</span><span class="nb">KD</span><span class="o">(</span><span class="nb">s</span><span class="o">)</span><span class="nb">G</span><span class="o">(</span><span class="nb">s</span><span class="o">)=</span><span class="nv">\dfrac</span><span class="nb">{</span><span class="m">4</span><span class="o">(</span><span class="m">1</span><span class="o">+</span><span class="nb">s</span><span class="o">)</span><span class="nb">}{s^</span><span class="m">2</span><span class="o">(</span><span class="m">1</span><span class="o">+</span><span class="m">0</span><span class="nb">.</span><span class="m">1</span><span class="nb">s</span><span class="o">)</span><span class="nb">}</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'><span class="k">\draw</span> (KDG.west) edge [-&gt;, shorten &gt;=1pt, thick, blue, bend right=1.5]
</span><span class='line'>    (0.17, 10);
</span><span class='line'>
</span><span class='line'><span class="c">% Axes label</span>
</span><span class='line'><span class="k">\node</span> [below=6pt] at (0.5,-50) <span class="nb">{</span>Frequency, <span class="s">$</span><span class="nv">\omega</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'><span class="k">\node</span> [rotate=90] at (-1.25,5) <span class="nb">{</span>Magnitude, <span class="s">$</span><span class="m">20</span><span class="nv">\log</span><span class="o">(</span><span class="nb">|G</span><span class="o">(</span><span class="nv">\text</span><span class="nb">{j}</span><span class="nv">\omega</span><span class="o">)</span><span class="nb">|</span><span class="o">)</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>scope<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>scope<span class="nb">}</span>[yshift=-3.5cm,yscale=4/180]
</span><span class='line'><span class="k">\UniteDegre</span>
</span><span class='line'><span class="k">\OrdBode</span><span class="nb">{</span>30<span class="nb">}</span>
</span><span class='line'><span class="k">\semilog</span><span class="nb">{</span>-1<span class="nb">}{</span>2<span class="nb">}{</span>-180<span class="nb">}{</span>0<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Bode plot (phase) for the original system, 4/(s/(1+2s)).</span>
</span><span class='line'><span class="c">% Asymptotic line</span>
</span><span class='line'><span class="k">\BodeArg</span><span class="na">[ref lines, red!60]</span><span class="nb">{</span>-1:2<span class="nb">}{</span><span class="k">\POArgAsymp</span><span class="nb">{</span>4<span class="nb">}{</span>2.0<span class="nb">}</span>+<span class="k">\IntArg</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'><span class="c">% Bode plot</span>
</span><span class='line'><span class="k">\BodeArg</span><span class="na">[bode lines, red, name path=Gophase]</span><span class="nb">{</span>-1:2<span class="nb">}{</span><span class="k">\POArg</span><span class="nb">{</span>4<span class="nb">}{</span>2<span class="nb">}</span>+<span class="k">\IntArg</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Bode plot (magnitude) for the compensated system, 4(1+s)/(s^2/(1+0.1s)).</span>
</span><span class='line'><span class="c">% Asymptotic line</span>
</span><span class='line'><span class="k">\BodeArg</span><span class="na">[ref lines]</span><span class="nb">{</span>-1:2<span class="nb">}{</span><span class="k">\APArgAsymp</span><span class="nb">{</span>4<span class="nb">}{</span>0.1<span class="nb">}{</span>10<span class="nb">}</span>+2*<span class="k">\IntArg</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'><span class="c">% Bode plot</span>
</span><span class='line'><span class="k">\BodeArg</span><span class="na">[bode lines, name path=phase]</span><span class="nb">{</span>-1:2<span class="nb">}{</span><span class="k">\APArg</span><span class="nb">{</span>4<span class="nb">}{</span>0.1<span class="nb">}{</span>10<span class="nb">}</span>+2*<span class="k">\IntArg</span><span class="nb">{</span>1<span class="nb">}}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Phase margin of the original system</span>
</span><span class='line'><span class="k">\path</span> [name path=Gowcref] (Gocrossover) -- ++(0,-330);
</span><span class='line'><span class="k">\path</span> [name intersections=<span class="nb">{</span>of=Gophase and Gowcref, by=Gophasemargin<span class="nb">}</span>];
</span><span class='line'><span class="k">\node</span> (Gopmref) [ref points] at (Gophasemargin) <span class="nb">{}</span>;
</span><span class='line'><span class="k">\draw</span> [ref lines, red!60, densely dotted] (Gocoref.south) -- (Gopmref.north);
</span><span class='line'><span class="k">\draw</span> [ref lines, &lt;-&gt;, red] let <span class="k">\p</span>1=(Gophasemargin)
</span><span class='line'>    in
</span><span class='line'>        (Gopmref.south) -- node[left, Gclabel, text=red] <span class="nb">{</span><span class="s">$</span><span class="nv">\text</span><span class="nb">{PM}_o</span><span class="s">$</span><span class="nb">}</span> (<span class="k">\x</span>1,-180);
</span><span class='line'>
</span><span class='line'><span class="c">% Phase margin of the compensated system</span>
</span><span class='line'><span class="k">\path</span><span class="na">[name path=wcref]</span> (crossover) -- ++(0,-300);
</span><span class='line'><span class="k">\path</span> [name intersections=<span class="nb">{</span>of=phase and wcref, by=phasemargin<span class="nb">}</span>];
</span><span class='line'><span class="k">\node</span> (pmref) [ref points] at (phasemargin) <span class="nb">{}</span>;
</span><span class='line'><span class="k">\draw</span> [ref lines, densely dotted] (coref.south) -- (pmref.north);
</span><span class='line'><span class="k">\draw</span> [ref lines, &lt;-&gt;, blue] let <span class="k">\p</span>1=(phasemargin)
</span><span class='line'>    in
</span><span class='line'>        (pmref.south) -- node[left, Gclabel] <span class="nb">{</span>PM<span class="nb">}</span> (<span class="k">\x</span>1,-180);
</span><span class='line'>
</span><span class='line'><span class="c">% System Labels</span>
</span><span class='line'><span class="k">\node</span> (KGphase) [Gclabel, red!60, text=red, draw]
</span><span class='line'>    at (-0.5, -40) <span class="nb">{</span><span class="s">$</span><span class="nb">KG</span><span class="o">(</span><span class="nb">s</span><span class="o">)=</span><span class="nv">\dfrac</span><span class="nb">{</span><span class="m">4</span><span class="nb">}{s</span><span class="o">(</span><span class="m">1</span><span class="o">+</span><span class="m">2</span><span class="nb">s</span><span class="o">)</span><span class="nb">}</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'><span class="k">\draw</span><span class="na">[-&gt;, shorten &gt;=1pt, thick, red]</span>
</span><span class='line'>    (KGphase.south) .. controls +(down:30) and +(0.1,10) .. (-0.65, -114);
</span><span class='line'>
</span><span class='line'><span class="k">\node</span> (KDGphase) [Gclabel, blue!60, text=blue, draw]
</span><span class='line'>    at (1.4, -40) <span class="nb">{</span><span class="s">$</span><span class="nb">KD</span><span class="o">(</span><span class="nb">s</span><span class="o">)</span><span class="nb">G</span><span class="o">(</span><span class="nb">s</span><span class="o">)=</span><span class="nv">\dfrac</span><span class="nb">{</span><span class="m">4</span><span class="o">(</span><span class="m">1</span><span class="o">+</span><span class="nb">s</span><span class="o">)</span><span class="nb">}{s^</span><span class="m">2</span><span class="o">(</span><span class="m">1</span><span class="o">+</span><span class="m">0</span><span class="nb">.</span><span class="m">1</span><span class="nb">s</span><span class="o">)</span><span class="nb">}</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'><span class="k">\draw</span><span class="na">[-&gt;, shorten &gt;=1pt, thick, blue]</span>
</span><span class='line'>    (KDGphase.south) .. controls +(down:40) and +(0.1,30) .. (1.1, -146);
</span><span class='line'>
</span><span class='line'><span class="c">% Axes label</span>
</span><span class='line'><span class="k">\node</span> [below=6pt] at (0.5, -180) <span class="nb">{</span>Frequency, <span class="s">$</span><span class="nv">\omega</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'><span class="k">\node</span> [rotate=90] at (-1.25, -90) <span class="nb">{</span>Phase, <span class="s">$</span><span class="nv">\angle</span><span class="nb"> G</span><span class="o">(</span><span class="nv">\text</span><span class="nb">{j}</span><span class="nv">\omega</span><span class="o">)</span><span class="s">$</span><span class="nb">}</span>;
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>scope<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="c">% Background</span>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>pgfonlayer<span class="nb">}{</span>background<span class="nb">}</span>
</span><span class='line'>    <span class="k">\path</span> (-1.4cm,2.8cm) node (tl) <span class="nb">{}</span>;
</span><span class='line'>    <span class="k">\path</span> (2.3cm, -8.4cm) node (br) <span class="nb">{}</span>;
</span><span class='line'>
</span><span class='line'>    <span class="k">\path</span><span class="na">[fill=brown!20]</span> (tl) rectangle (br);
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>pgfonlayer<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>document<span class="nb">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Here is he thumbnail of the plot. You can find the <a href="http://cid-e5b806d2c8679f5d.skydrive.live.com/self.aspx/Public/TeX/bodeplot.tex">tex</a> and <a href="http://cid-e5b806d2c8679f5d.skydrive.live.com/self.aspx/Public/TeX/bodeplot.pdf">pdf</a> file from my SkyDrive.</p>

<p class="fn-img"><img src="https://raw.github.com/Khaos/TikZGallery/master/Figs/png/pgf-o-Bodeplot.png" alt="降龙十八掌" /></p>

<p class="info">Update: <br />
    The code has been included in the PGF/Ti<em>k</em>Z gallery, <a href="http://www.texample.net/">TeXample.net</a>, see <a href="http://www.texample.net/tikz/examples/bode-plot/">here</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[形而上者谓之道，形而下者谓之器 —— LyX学习小记]]></title>
    <link href="http://Khaos.github.com/blog/2008/06/18/trying-lyx/"/>
    <updated>2008-06-18T00:00:00+08:00</updated>
    <id>http://Khaos.github.com/blog/2008/06/18/trying-lyx</id>
    <content type="html"><![CDATA[<p class="warning">08年的文章（格式还保持WP原样），后面坑有点大，我不打算填了。因为虽然也用LyX，但是写较大的文档我还是习惯用LaTeX（主要是我要用Makefile来控制整个编译过程），也许以后会有LyX的一些介绍。</p>

<!-- more -->

<p><div id="msgcns!E5B806D2C8679F5D!154" class="bvMsg"><p>  </p><p>|----------------------------------------- <font color="#ff8000">看什么看，没见过分隔符?</font> -----------------------------------------|  </p><h5>小引1</h5> <p>形而上者谓之道，形而下者谓之器。 —— 《易经 · 系辞》  </p><p>|----------------------------------------- <font color="#ff8000">看什么看，没见过分隔符?</font> -----------------------------------------|  </p><h5>小引2</h5> <table cellspacing="0" cellpadding="2" width="478" border="0"> <tbody> <tr> <td valign="top" width="79">TeX/LaTeX  </td><td valign="top" width="41">---&gt;  </td><td valign="top" width="356">WYSIWYAF (what you see is what you asked for)  </td></tr><tr> <td valign="top" width="79">LyX  </td><td valign="top" width="42">---&gt;  </td><td valign="top" width="356">WYSIWYM (what you see is what you mean)  </td></tr><tr> <td valign="top" width="79">Word  </td><td valign="top" width="43">---&gt;  </td><td valign="top" width="356">WYSIWYG (what you see is what you get)</td></tr></tbody></table> <p>|----------------------------------------- <font color="#ff8000">看什么看，没见过分隔符?</font> -----------------------------------------|  </p><h5>小引3</h5> <p>接触LyX一周有余，颇有所得，这里小记一下。  </p><p>（此篇归入《易筋经》）  </p><p>|----------------------------------------- <font color="#ff8000">看什么看，没见过分隔符?</font> -----------------------------------------|  </p><p>说到LyX，不得不先说说TeX/LaTeX和Word。我于97年接触Microsoft Word，2000年用它写了第一篇毕业论文。记得当时只是插入了十几张图和几十个公式，在586的机器上真是把我折磨的欲仙欲死。于是从Word XP开始奋发图强，学习宏命令，学做交叉引用、目录和动画，等等。至2003年前后，各种18般武器都在Word上面试了个遍，自感脱离noob之列，不仅飘飘然起来。可惜好景不长，2004年底，有幸读到了侯捷先生的《Word排版艺术》一书，才知道于Word我只略通皮毛，而于精华只是初窥门径。虽然不免灰心丧气，但也看到Word之笨拙，有时甚至不近人情，不食人间烟火的倔强之处。于是，我决定，摒弃Word，皈依TeX/LaTeX。  </p><p>对于TeX，并非一见钟情。我在2000年就耳闻TeX/LaTeX，但是一直没有兴趣研究，一个是那个时候TeX/LaTeX的中文支持不好，而其时我也从不写英文论文，再一个它的门槛较高，没有目标的学习如同嚼蜡。注定要与TeX/LaTeX结缘，2006年我需要写一篇图、文、式（公式）并茂的英文论文。想起用Word时抓狂的样子，终于下决心这回用TeX/LaTeX来写！于是找来CTeX（一个中文TeX<del>宏包</del>系统，初学者的上选，可以到<a href="http://www.ctex.org">这里</a>下载）安装包，借来参考书，似模似样的写起来。一个月下来，竟然不知不觉“轻舟已过万重山”，一份70来页的文档跃然纸上。麻雀虽小，却也包含了Graph, Table, Equation, Algorithm, Theorem，以及Content, Reference, Cross-reference和Bookmark，等等。至此，不仅于LaTeX相见恨晚，似乎并没有想象中的那么难学。于是两年来，PC上再也没有出现过超过10页的Word文档。几篇文档写下来，手法日臻纯熟，于TeX确越发敬畏起来，实感其之博大精深，回想Word，现在只能称之为“字处理软件”，而非“排版软件”，在TeX面前，似乎有些小巫见大巫。慢慢的，迷恋于TeX不能自拔，用它写Report，写Memorandum，写Presentation，甚至在LaTeX中做pdf动画。  </p><p>（未完...）</p></div></p>
]]></content>
  </entry>
  
</feed>
